---
title: Associazione di modelli in ASP.NET Core
author: tdykstra
description: Informazioni su come l'associazione di modelli in ASP.NET Core MVC esegue il mapping dei dati dalle richieste HTTP ai parametri dei metodi di azione.
ms.assetid: 0be164aa-1d72-4192-bd6b-192c9c301164
ms.author: tdykstra
ms.date: 11/13/2018
uid: mvc/models/model-binding
ms.openlocfilehash: 1dc9b41328ed78440622acc1865b6f088d394403
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/01/2019
ms.locfileid: "57037048"
---
# <a name="model-binding-in-aspnet-core"></a><span data-ttu-id="b2bdc-103">Associazione di modelli in ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="b2bdc-103">Model Binding in ASP.NET Core</span></span>

<span data-ttu-id="b2bdc-104">[Rachel Appel](https://github.com/rachelappel)</span><span class="sxs-lookup"><span data-stu-id="b2bdc-104">By [Rachel Appel](https://github.com/rachelappel)</span></span>

## <a name="introduction-to-model-binding"></a><span data-ttu-id="b2bdc-105">Introduzione all'associazione di modelli</span><span class="sxs-lookup"><span data-stu-id="b2bdc-105">Introduction to model binding</span></span>

<span data-ttu-id="b2bdc-106">L'associazione di modelli in ASP.NET Core MVC esegue il mapping dei dati dalle richieste HTTP ai parametri dei metodi di azione.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-106">Model binding in ASP.NET Core MVC maps data from HTTP requests to action method parameters.</span></span> <span data-ttu-id="b2bdc-107">I parametri possono essere di tipo semplice, ad esempio stringa, integer o float, o di tipo complesso.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-107">The parameters may be simple types such as strings, integers, or floats, or they may be complex types.</span></span> <span data-ttu-id="b2bdc-108">Questa è una funzionalità di MVC eccezionale, poiché il mapping di dati in ingresso con una controparte è uno scenario che si ripete spesso, indipendentemente dalle dimensioni o dalla complessità dei dati.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-108">This is a great feature of MVC because mapping incoming data to a counterpart is an often repeated scenario, regardless of size or complexity of the data.</span></span> <span data-ttu-id="b2bdc-109">MVC risolve questo problema astraendo l'associazione. Gli sviluppatori non devono quindi continuare a scrivere una versione leggermente diversa dello stesso codice in ogni app.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-109">MVC solves this problem by abstracting binding away so developers don't have to keep rewriting a slightly different version of that same code in every app.</span></span> <span data-ttu-id="b2bdc-110">Scrivere testo personalizzato all'interno di codice convertitore di tipi è tedioso e soggetto a errori.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-110">Writing your own text to type converter code is tedious, and error prone.</span></span>

## <a name="how-model-binding-works"></a><span data-ttu-id="b2bdc-111">Funzionamento dell'associazione di modelli</span><span class="sxs-lookup"><span data-stu-id="b2bdc-111">How model binding works</span></span>

<span data-ttu-id="b2bdc-112">Quando MVC riceve una richiesta HTTP, la instrada a un metodo di azione specifico di un controller.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-112">When MVC receives an HTTP request, it routes it to a specific action method of a controller.</span></span> <span data-ttu-id="b2bdc-113">Determina il metodo di azione da eseguire in base al contenuto dei dati della route e quindi associa i valori dalla richiesta HTTP ai parametri del metodo di azione stesso.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-113">It determines which action method to run based on what is in the route data, then it binds values from the HTTP request to that action method's parameters.</span></span> <span data-ttu-id="b2bdc-114">Si consideri ad esempio l'URL seguente:</span><span class="sxs-lookup"><span data-stu-id="b2bdc-114">For example, consider the following URL:</span></span>

`http://contoso.com/movies/edit/2`

<span data-ttu-id="b2bdc-115">Poiché il modello di route è simile a `{controller=Home}/{action=Index}/{id?}`, `movies/edit/2` esegue l'instradamento al controller `Movies` e al relativo metodo di azione `Edit`.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-115">Since the route template looks like this, `{controller=Home}/{action=Index}/{id?}`, `movies/edit/2` routes to the `Movies` controller, and its `Edit` action method.</span></span> <span data-ttu-id="b2bdc-116">Accetta anche un parametro facoltativo denominato `id`.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-116">It also accepts an optional parameter called `id`.</span></span> <span data-ttu-id="b2bdc-117">Il codice per il metodo di azione dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="b2bdc-117">The code for the action method should look something like this:</span></span>

```csharp
public IActionResult Edit(int? id)
   ```

<span data-ttu-id="b2bdc-118">Nota: Le stringhe nella route dell'URL non sono tra maiuscole e minuscole.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-118">Note: The strings in the URL route are not case sensitive.</span></span>

<span data-ttu-id="b2bdc-119">MVC tenta di associare i dati della richiesta ai parametri dell'azione in base al nome.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-119">MVC will try to bind request data to the action parameters by name.</span></span> <span data-ttu-id="b2bdc-120">MVC cerca i valori per ogni parametro usando il nome del parametro e i nomi delle proprietà impostabili pubbliche.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-120">MVC will look for values for each parameter using the parameter name and the names of its public settable properties.</span></span> <span data-ttu-id="b2bdc-121">Nell'esempio precedente, l'unico parametro di azione, denominato `id`, viene associato da MVC al valore con lo stesso nome nei valori di route.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-121">In the above example, the only action parameter is named `id`, which MVC binds to the value with the same name in the route values.</span></span> <span data-ttu-id="b2bdc-122">Oltre ai valori di route, MVC associa dati da varie parti della richiesta ed esegue l'operazione in un ordine stabilito.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-122">In addition to route values MVC will bind data from various parts of the request and it does so in a set order.</span></span> <span data-ttu-id="b2bdc-123">Di seguito è riportato un elenco delle origini dati nell'ordine in cui vengono esaminate dall'associazione di modelli:</span><span class="sxs-lookup"><span data-stu-id="b2bdc-123">Below is a list of the data sources in the order that model binding looks through them:</span></span>

1. <span data-ttu-id="b2bdc-124">`Form values`: Questi sono i valori del form inseriti nella richiesta HTTP con il metodo POST.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-124">`Form values`: These are form values that go in the HTTP request using the POST method.</span></span> <span data-ttu-id="b2bdc-125">incluse le richieste POST jQuery.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-125">(including jQuery POST requests).</span></span>

2. <span data-ttu-id="b2bdc-126">`Route values`: Il set di valori di route specificati dal [Routing](xref:fundamentals/routing)</span><span class="sxs-lookup"><span data-stu-id="b2bdc-126">`Route values`: The set of route values provided by [Routing](xref:fundamentals/routing)</span></span>

3. <span data-ttu-id="b2bdc-127">`Query strings`: La parte di stringa di query dell'URI.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-127">`Query strings`: The query string part of the URI.</span></span>

<!-- DocFX BUG
The link works but generates an error when building with DocFX
@fundamentals/routing
[Routing](xref:fundamentals/routing)
-->

<span data-ttu-id="b2bdc-128">Nota: I valori del form, i dati della route e le stringhe vengono archiviate come coppie nome-valore di query.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-128">Note: Form values, route data, and query strings are all stored as name-value pairs.</span></span>

<span data-ttu-id="b2bdc-129">Poiché l'associazione di modelli ha richiesto una chiave denominata `id` e nei valori del form nessun elemento è denominato `id`, l'associazione di modelli cerca tale chiave passando ai valori della route.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-129">Since model binding asked for a key named `id` and there's nothing named `id` in the form values, it moved on to the route values looking for that key.</span></span> <span data-ttu-id="b2bdc-130">In questo esempio, esiste una corrispondenza.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-130">In our example, it's a match.</span></span> <span data-ttu-id="b2bdc-131">L'associazione viene eseguita e il valore viene convertito nell'integer 2.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-131">Binding happens, and the value is converted to the integer 2.</span></span> <span data-ttu-id="b2bdc-132">Se nella stessa richiesta fosse usata l'espressione Edit(string id), il risultato della conversione sarebbe la stringa "2".</span><span class="sxs-lookup"><span data-stu-id="b2bdc-132">The same request using Edit(string id) would convert to the string "2".</span></span>

<span data-ttu-id="b2bdc-133">Finora l'esempio ha usato tipi semplici.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-133">So far the example uses simple types.</span></span> <span data-ttu-id="b2bdc-134">In MVC sono considerati tipi semplici tutti i tipi primitivi .NET o i tipi con un convertitore di tipo stringa.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-134">In MVC simple types are any .NET primitive type or type with a string type converter.</span></span> <span data-ttu-id="b2bdc-135">Se il parametro del metodo di azione fosse una classe, ad esempio il tipo `Movie`, contenente sia tipi semplici che tipi complessi come proprietà, l'associazione di modelli di MVC sarebbe comunque in grado di gestirlo correttamente,</span><span class="sxs-lookup"><span data-stu-id="b2bdc-135">If the action method's parameter were a class such as the `Movie` type, which contains both simple and complex types as properties, MVC's model binding will still handle it nicely.</span></span> <span data-ttu-id="b2bdc-136">usando la reflection e la ricorsione per cercare corrispondenze attraverso le proprietà corrispondenti ai tipi complessi.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-136">It uses reflection and recursion to traverse the properties of complex types looking for matches.</span></span> <span data-ttu-id="b2bdc-137">Per associare i valori alle proprietà, l'associazione di modelli cerca il modello *nome_parametro.nome_proprietà*.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-137">Model binding looks for the pattern *parameter_name.property_name* to bind values to properties.</span></span> <span data-ttu-id="b2bdc-138">Se non trova valori corrispondenti nel form, tenta di eseguire l'associazione usando solo il nome della proprietà.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-138">If it doesn't find matching values of this form, it will attempt to bind using just the property name.</span></span> <span data-ttu-id="b2bdc-139">Per i tipi quali `Collection`, l'associazione di modelli cerca le corrispondenze in base a *nome_parametro[indice]* o semplicemente *[indice]*.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-139">For those types such as `Collection` types, model binding looks for matches to *parameter_name[index]* or just *[index]*.</span></span> <span data-ttu-id="b2bdc-140">L'associazione di modelli considera i tipi `Dictionary` in modo analogo, richiedendo *nome_parametro[chiave]* o semplicemente *[chiave]*, purché le chiavi siano di tipo semplice.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-140">Model binding treats  `Dictionary` types similarly, asking for *parameter_name[key]* or just *[key]*, as long as the keys are simple types.</span></span> <span data-ttu-id="b2bdc-141">Le chiavi supportate corrispondono ai nomi di campo HTML e agli helper tag generati per lo stesso tipo di modello.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-141">Keys that are supported match the field names HTML and tag helpers generated for the same model type.</span></span> <span data-ttu-id="b2bdc-142">Ciò consente l'uso di valori di andata e ritorno, in modo che i campi modulo rimangano compilati con l'input dell'utente per praticità, ad esempio quando i dati associati provenienti da un'istruzione di creazione o modifica non superano la convalida.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-142">This enables round-tripping values so that the form fields remain filled with the user's input for their convenience, for example, when bound data from a create or edit didn't pass validation.</span></span>

<span data-ttu-id="b2bdc-143">Per consentire l'associazione di modelli, la classe deve avere un costruttore predefinito pubblico e proprietà scrivibili pubbliche da associare.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-143">To make model binding possible, the class must have a public default constructor and public writable properties to bind.</span></span> <span data-ttu-id="b2bdc-144">Quando si verifica l'associazione di modelli, vengono create istanze della classe usando il costruttore predefinito pubblico. Quindi è possibile impostare le proprietà.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-144">When model binding occurs, the class is instantiated using the public default constructor, then the properties can be set.</span></span>

<span data-ttu-id="b2bdc-145">Quando un parametro viene associato, l'associazione di modelli interrompe la ricerca di valori con quel nome e passa ad associare il parametro successivo.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-145">When a parameter is bound, model binding stops looking for values with that name and it moves on to bind the next parameter.</span></span> <span data-ttu-id="b2bdc-146">In caso contrario, il comportamento predefinito dell'associazione di modelli imposta i parametri sui valori predefiniti di questi a seconda del loro tipo:</span><span class="sxs-lookup"><span data-stu-id="b2bdc-146">Otherwise, the default model binding behavior sets parameters to their default values depending on their type:</span></span>

* <span data-ttu-id="b2bdc-147">`T[]`: Fatta eccezione per le matrici di tipo `byte[]`, associazione imposta i parametri di tipo `T[]` a `Array.Empty<T>()`.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-147">`T[]`: With the exception of arrays of type `byte[]`, binding sets parameters of type `T[]` to `Array.Empty<T>()`.</span></span> <span data-ttu-id="b2bdc-148">Le matrici di tipo `byte[]` vengono impostate su `null`.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-148">Arrays of type `byte[]` are set to `null`.</span></span>

* <span data-ttu-id="b2bdc-149">Tipi di riferimento: Associazione crea un'istanza di una classe con il costruttore predefinito senza impostare le proprietà.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-149">Reference Types: Binding creates an instance of a class with the default constructor without setting properties.</span></span> <span data-ttu-id="b2bdc-150">L'associazione di modelli, tuttavia, imposta i parametri `string` su `null`.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-150">However, model binding sets `string` parameters to `null`.</span></span>

* <span data-ttu-id="b2bdc-151">Tipi nullable: Tipi nullable vengono impostati su `null`.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-151">Nullable Types: Nullable types are set to `null`.</span></span> <span data-ttu-id="b2bdc-152">Nell'esempio precedente, l'associazione di modelli imposta `id` su `null`, perché è di tipo `int?`.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-152">In the above example, model binding sets `id` to `null` since it's of type `int?`.</span></span>

* <span data-ttu-id="b2bdc-153">Tipi di valore: Tipi di valore non-nullable di tipo `T` sono impostati su `default(T)`.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-153">Value Types: Non-nullable value types of type `T` are set to `default(T)`.</span></span> <span data-ttu-id="b2bdc-154">L'associazione di modelli, ad esempio, imposta un parametro `int id` su 0.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-154">For example, model binding will set a parameter `int id` to 0.</span></span> <span data-ttu-id="b2bdc-155">Anziché basarsi sui valori predefiniti, è consigliabile usare la convalida del modello o tipi nullable.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-155">Consider using model validation or nullable types rather than relying on default values.</span></span>

<span data-ttu-id="b2bdc-156">Se l'associazione non riesce, MVC non genera un errore.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-156">If binding fails, MVC doesn't throw an error.</span></span> <span data-ttu-id="b2bdc-157">Tutte le azioni che accettano input utente devono controllare la proprietà `ModelState.IsValid`.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-157">Every action which accepts user input should check the `ModelState.IsValid` property.</span></span>

<span data-ttu-id="b2bdc-158">Nota: Ogni voce del controller `ModelState` proprietà è una `ModelStateEntry` contenente un `Errors` proprietà.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-158">Note: Each entry in the controller's `ModelState` property is a `ModelStateEntry` containing an `Errors` property.</span></span> <span data-ttu-id="b2bdc-159">È raro che sia necessario eseguire query in questa raccolta personalmente.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-159">It's rarely necessary to query this collection yourself.</span></span> <span data-ttu-id="b2bdc-160">In alternativa, usare `ModelState.IsValid`.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-160">Use `ModelState.IsValid` instead.</span></span>

<span data-ttu-id="b2bdc-161">Esistono anche alcuni tipi di dati speciali che MVC deve prendere in considerazione quando esegue l'associazione di modelli:</span><span class="sxs-lookup"><span data-stu-id="b2bdc-161">Additionally, there are some special data types that MVC must consider when performing model binding:</span></span>

* <span data-ttu-id="b2bdc-162">`IFormFile`, `IEnumerable<IFormFile>`: Uno o più file caricati che fanno parte della richiesta HTTP.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-162">`IFormFile`, `IEnumerable<IFormFile>`: One or more uploaded files that are part of the HTTP request.</span></span>

* <span data-ttu-id="b2bdc-163">`CancellationToken`: Utilizzato per annullare l'attività nei controller asincroni.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-163">`CancellationToken`: Used to cancel activity in asynchronous controllers.</span></span>

<span data-ttu-id="b2bdc-164">Questi tipi possono essere associati a parametri di azione o a proprietà per un tipo classe.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-164">These types can be bound to action parameters or to properties on a class type.</span></span>

<span data-ttu-id="b2bdc-165">Quando l'associazione di modelli è completata viene eseguita la [convalida](validation.md).</span><span class="sxs-lookup"><span data-stu-id="b2bdc-165">Once model binding is complete, [Validation](validation.md) occurs.</span></span> <span data-ttu-id="b2bdc-166">L'associazione di modelli predefinita è perfetta per la grande maggioranza degli scenari di sviluppo.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-166">Default model binding works great for the vast majority of development scenarios.</span></span> <span data-ttu-id="b2bdc-167">È anche estendibile. In caso di esigenze molto particolari, quindi, è possibile personalizzare il comportamento predefinito.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-167">It's also extensible so if you have unique needs you can customize the built-in behavior.</span></span>

## <a name="customize-model-binding-behavior-with-attributes"></a><span data-ttu-id="b2bdc-168">Personalizzare il comportamento dell'associazione di modelli con attributi</span><span class="sxs-lookup"><span data-stu-id="b2bdc-168">Customize model binding behavior with attributes</span></span>

<span data-ttu-id="b2bdc-169">MVC contiene diversi attributi che è possibile usare per indirizzare il comportamento predefinito dell'associazione di modelli verso un'origine diversa.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-169">MVC contains several attributes that you can use to direct its default model binding behavior to a different source.</span></span> <span data-ttu-id="b2bdc-170">È ad esempio possibile specificare se per una proprietà l'associazione è obbligatoria o se non deve mai essere eseguita tramite l'attributo `[BindRequired]` o `[BindNever]`, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-170">For example, you can specify whether binding is required for a property, or if it should never happen at all by using the `[BindRequired]` or `[BindNever]` attributes.</span></span> <span data-ttu-id="b2bdc-171">In alternativa, è possibile eseguire l'override dell'origine dati predefinita e specificare l'origine dati dello strumento di associazione di modelli.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-171">Alternatively, you can override the default data source, and specify the model binder's data source.</span></span> <span data-ttu-id="b2bdc-172">Di seguito è riportato un elenco di attributi di associazione di modelli:</span><span class="sxs-lookup"><span data-stu-id="b2bdc-172">Below is a list of model binding attributes:</span></span>

* <span data-ttu-id="b2bdc-173">`[BindRequired]`: Questo attributo aggiunge un errore di stato del modello se non è possibile eseguire l'associazione.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-173">`[BindRequired]`: This attribute adds a model state error if binding cannot occur.</span></span>

* <span data-ttu-id="b2bdc-174">`[BindNever]`: Indica il gestore di associazione del modello non eseguire mai associazioni al parametro.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-174">`[BindNever]`: Tells the model binder to never bind to this parameter.</span></span>

* <span data-ttu-id="b2bdc-175">`[FromHeader]`, `[FromQuery]`, `[FromRoute]`, `[FromForm]`: Utilizzati per specificare l'origine di associazione precisa da applicare.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-175">`[FromHeader]`, `[FromQuery]`, `[FromRoute]`, `[FromForm]`: Use these to specify the exact binding source you want to apply.</span></span>

* <span data-ttu-id="b2bdc-176">`[FromServices]`: Questo attributo viene usato [inserimento delle dipendenze](../../fundamentals/dependency-injection.md) per associare i parametri di servizi.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-176">`[FromServices]`: This attribute uses [dependency injection](../../fundamentals/dependency-injection.md) to bind parameters from services.</span></span>

* <span data-ttu-id="b2bdc-177">`[FromBody]`: Usare i formattatori configurati per associare i dati dal corpo della richiesta.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-177">`[FromBody]`: Use the configured formatters to bind data from the request body.</span></span> <span data-ttu-id="b2bdc-178">Il formattatore viene selezionato in base al tipo di contenuto della richiesta.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-178">The formatter is selected based on content type of the request.</span></span>

* <span data-ttu-id="b2bdc-179">`[ModelBinder]`: Utilizzato per ignorare il raccoglitore dei modelli predefiniti, binding di origine e il nome.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-179">`[ModelBinder]`: Used to override the default model binder, binding source and name.</span></span>

<span data-ttu-id="b2bdc-180">Gli attributi sono strumenti molto utili quando è necessario eseguire l'override del comportamento predefinito dell'associazione di modelli.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-180">Attributes are very helpful tools when you need to override the default behavior of model binding.</span></span>

## <a name="customize-model-binding-and-validation-globally"></a><span data-ttu-id="b2bdc-181">Personalizzare l'associazione di modelli e la convalida a livello globale</span><span class="sxs-lookup"><span data-stu-id="b2bdc-181">Customize model binding and validation globally</span></span>

<span data-ttu-id="b2bdc-182">Il comportamento dell'associazione di modelli e del sistema di convalida è determinato da [ModelMetadata](/dotnet/api/microsoft.aspnetcore.mvc.modelbinding.modelmetadata) che descrive:</span><span class="sxs-lookup"><span data-stu-id="b2bdc-182">The model binding and validation system's behavior is driven by [ModelMetadata](/dotnet/api/microsoft.aspnetcore.mvc.modelbinding.modelmetadata) that describes:</span></span>

* <span data-ttu-id="b2bdc-183">Il modo in cui è necessario associare un modello.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-183">How a model is to be bound.</span></span>
* <span data-ttu-id="b2bdc-184">Il modo in cui viene eseguita la convalida sul tipo e sulle relative proprietà.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-184">How validation occurs on the type and its properties.</span></span>

<span data-ttu-id="b2bdc-185">È possibile configurare a livello globale alcuni aspetti del comportamento del sistema aggiungendo un provider di dettagli a [MvcOptions.ModelMetadataDetailsProviders](/dotnet/api/microsoft.aspnetcore.mvc.mvcoptions.modelmetadatadetailsproviders#Microsoft_AspNetCore_Mvc_MvcOptions_ModelMetadataDetailsProviders).</span><span class="sxs-lookup"><span data-stu-id="b2bdc-185">Aspects of the system's behavior can be configured globally by adding a details provider to [MvcOptions.ModelMetadataDetailsProviders](/dotnet/api/microsoft.aspnetcore.mvc.mvcoptions.modelmetadatadetailsproviders#Microsoft_AspNetCore_Mvc_MvcOptions_ModelMetadataDetailsProviders).</span></span> <span data-ttu-id="b2bdc-186">MVC include alcuni provider di dettagli predefiniti che consentono di configurare comportamenti quali la disabilitazione dell'associazione di modelli o della convalida per determinati tipi.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-186">MVC has a few built-in details providers that allow configuring behavior such as disabling model binding or validation for certain types.</span></span>

<span data-ttu-id="b2bdc-187">Per disabilitare l'associazione di modelli per tutti i modelli di un determinato tipo, aggiungere un elemento [ExcludeBindingMetadataProvider](/dotnet/api/microsoft.aspnetcore.mvc.modelbinding.metadata.excludebindingmetadataprovider) in `Startup.ConfigureServices`.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-187">To disable model binding on all models of a certain type, add an [ExcludeBindingMetadataProvider](/dotnet/api/microsoft.aspnetcore.mvc.modelbinding.metadata.excludebindingmetadataprovider) in `Startup.ConfigureServices`.</span></span> <span data-ttu-id="b2bdc-188">Ad esempio, per disabilitare l'associazione di modelli per tutti i modelli di tipo `System.Version`:</span><span class="sxs-lookup"><span data-stu-id="b2bdc-188">For example, to disable model binding on all models of type `System.Version`:</span></span>

```csharp
services.AddMvc().AddMvcOptions(options =>
    options.ModelMetadataDetailsProviders.Add(
        new ExcludeBindingMetadataProvider(typeof(System.Version))));
```

<span data-ttu-id="b2bdc-189">Per disabilitare la convalida delle proprietà di un determinato tipo, aggiungere un elemento [SuppressChildValidationMetadataProvider](/dotnet/api/microsoft.aspnetcore.mvc.modelbinding.suppresschildvalidationmetadataprovider) in `Startup.ConfigureServices`.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-189">To disable validation on properties of a certain type, add a [SuppressChildValidationMetadataProvider](/dotnet/api/microsoft.aspnetcore.mvc.modelbinding.suppresschildvalidationmetadataprovider) in `Startup.ConfigureServices`.</span></span> <span data-ttu-id="b2bdc-190">Ad esempio, per disabilitare la convalida per le proprietà di tipo `System.Guid`:</span><span class="sxs-lookup"><span data-stu-id="b2bdc-190">For example, to disable validation on properties of type `System.Guid`:</span></span>

```csharp
services.AddMvc().AddMvcOptions(options =>
    options.ModelMetadataDetailsProviders.Add(
        new SuppressChildValidationMetadataProvider(typeof(System.Guid))));
```

## <a name="bind-formatted-data-from-the-request-body"></a><span data-ttu-id="b2bdc-191">Associare dati formattati dal corpo della richiesta</span><span class="sxs-lookup"><span data-stu-id="b2bdc-191">Bind formatted data from the request body</span></span>

<span data-ttu-id="b2bdc-192">I dati delle richieste possono avere un'ampia gamma di formati, ad esempio JSON, XML e molti altri.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-192">Request data can come in a variety of formats including JSON, XML and many others.</span></span> <span data-ttu-id="b2bdc-193">Quando si usa l'attributo [FromBody] per indicare che si vuole associare un parametro ai dati nel corpo della richiesta, MVC usa un set di formattatori configurato per gestire i dati della richiesta in base al tipo di contenuto di questa.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-193">When you use the [FromBody] attribute to indicate that you want to bind a parameter to data in the request body, MVC uses a configured set of formatters to handle the request data based on its content type.</span></span> <span data-ttu-id="b2bdc-194">Per impostazione predefinita, MVC include una classe `JsonInputFormatter` per la gestione dei dati JSON, ma è possibile aggiungere altri formattatori per la gestione del formato XML e di altri formati personalizzati.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-194">By default MVC includes a `JsonInputFormatter` class for handling JSON data, but you can add additional formatters for handling XML and other custom formats.</span></span>

> [!NOTE]
> <span data-ttu-id="b2bdc-195">Un solo parametro per ogni azione al massimo può essere decorato con `[FromBody]`.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-195">There can be at most one parameter per action decorated with `[FromBody]`.</span></span> <span data-ttu-id="b2bdc-196">Il runtime di ASP.NET Core MVC delega la responsabilità della lettura del flusso di richiesta al formattatore.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-196">The ASP.NET Core MVC run-time delegates the responsibility of reading the request stream to the formatter.</span></span> <span data-ttu-id="b2bdc-197">Dopo che il flusso di richiesta è stato letto per un parametro, non è in genere possibile leggerlo nuovamente per l'associazione di altri parametri `[FromBody]`.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-197">Once the request stream is read for a parameter, it's generally not possible to read the request stream again for binding other `[FromBody]` parameters.</span></span>

> [!NOTE]
> <span data-ttu-id="b2bdc-198">`JsonInputFormatter`, il formattatore predefinito, si basa su [Json.NET](https://www.newtonsoft.com/json).</span><span class="sxs-lookup"><span data-stu-id="b2bdc-198">The `JsonInputFormatter` is the default formatter and is based on [Json.NET](https://www.newtonsoft.com/json).</span></span>

<span data-ttu-id="b2bdc-199">ASP.NET Core seleziona i formattatori di input in base all'intestazione [Content-Type](https://www.w3.org/Protocols/rfc1341/4_Content-Type.html) e al tipo del parametro, a meno che un attributo applicato ad esso non specifichi diversamente.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-199">ASP.NET Core selects input formatters based on the [Content-Type](https://www.w3.org/Protocols/rfc1341/4_Content-Type.html) header and the type of the parameter, unless there's an attribute applied to it specifying otherwise.</span></span> <span data-ttu-id="b2bdc-200">Se si vuole usare codice XML o in un altro formato, è necessario eseguire la configurazione corrispondente nel file *Startup.cs*, ma prima può essere necessario ottenere un riferimento a `Microsoft.AspNetCore.Mvc.Formatters.Xml` tramite NuGet.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-200">If you'd like to use XML or another format you must configure it in the *Startup.cs* file, but you may first have to obtain a reference to `Microsoft.AspNetCore.Mvc.Formatters.Xml` using NuGet.</span></span> <span data-ttu-id="b2bdc-201">Il codice di avvio dovrebbe apparire come segue:</span><span class="sxs-lookup"><span data-stu-id="b2bdc-201">Your startup code should look something like this:</span></span>

```csharp
public void ConfigureServices(IServiceCollection services)
{
    services.AddMvc()
        .AddXmlSerializerFormatters();
   }
```

<span data-ttu-id="b2bdc-202">Il codice nel file *Startup.cs* contiene un metodo `ConfigureServices` con un argomento `services` che è possibile usare per compilare i servizi per l'app ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-202">Code in the *Startup.cs* file contains a `ConfigureServices` method with a `services` argument you can use to build up services for your ASP.NET Core app.</span></span> <span data-ttu-id="b2bdc-203">Nell'esempio viene aggiunto un formattatore XML come servizio offerto da MVC per questa app.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-203">In the sample, we are adding an XML formatter as a service that MVC will provide for this app.</span></span> <span data-ttu-id="b2bdc-204">L'argomento `options` passato al metodo `AddMvc` consente di aggiungere e gestire filtri, formattatori e altre opzioni di sistema da MVC dopo l'avvio dell'app.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-204">The `options` argument passed into the `AddMvc` method allows you to add and manage filters, formatters, and other system options from MVC upon app startup.</span></span> <span data-ttu-id="b2bdc-205">Applicare quindi l'attributo `Consumes` alle classi controller o ai metodi di azione per usare il formato voluto.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-205">Then apply the `Consumes` attribute to controller classes or action methods to work with the format you want.</span></span>

### <a name="custom-model-binding"></a><span data-ttu-id="b2bdc-206">Associazione di modelli personalizzata</span><span class="sxs-lookup"><span data-stu-id="b2bdc-206">Custom Model Binding</span></span>

<span data-ttu-id="b2bdc-207">È possibile estendere l'associazione di modelli scrivendo strumenti di associazione di modelli personalizzati.</span><span class="sxs-lookup"><span data-stu-id="b2bdc-207">You can extend model binding by writing your own custom model binders.</span></span> <span data-ttu-id="b2bdc-208">Altre informazioni sull'[associazione di modelli personalizzata](../advanced/custom-model-binding.md).</span><span class="sxs-lookup"><span data-stu-id="b2bdc-208">Learn more about [custom model binding](../advanced/custom-model-binding.md).</span></span>
